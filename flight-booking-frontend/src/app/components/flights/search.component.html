<div class="search-container">
  <div class="search-card">
    <h1>Search Flights</h1>
    
    <form [formGroup]="searchForm" (ngSubmit)="onSearch()">
      <div class="form-group">
        <label for="fromPlace">From</label>
        <div class="autocomplete-wrapper">
          <input 
            id="fromPlace"
            type="text" 
            formControlName="fromPlace"
            placeholder="e.g., Mumbai, Goa, Hyderabad"
            (input)="onFromInput($event)"
            (blur)="onFromBlur()"
            autocomplete="off"
            [class.invalid]="searchForm.get('fromPlace')?.invalid && searchForm.get('fromPlace')?.touched"
          />
          <ul class="suggestions" *ngIf="showFromSuggestions && fromSuggestions.length > 0">
            <li *ngFor="let city of fromSuggestions" (click)="selectFromCity(city)">
              {{ city }}
            </li>
          </ul>
          <div class="no-suggestions" *ngIf="showFromSuggestions && fromSuggestions.length === 0">
            No cities found
          </div>
        </div>
        <div class="field-error" *ngIf="searchForm.get('fromPlace')?.invalid && searchForm.get('fromPlace')?.touched">
          Please enter departure city
        </div>
      </div>

      <!-- TO PLACE WITH AUTOCOMPLETE -->
      <div class="form-group">
        <label for="toPlace">To</label>
        <div class="autocomplete-wrapper">
          <input 
            id="toPlace"
            type="text" 
            formControlName="toPlace"
            placeholder="e.g., Goa, Mumbai, Hyderabad" 
            (input)="onToInput($event)"
            (blur)="onToBlur()"
            autocomplete="off"
            [class.invalid]="searchForm.get('toPlace')?.invalid && searchForm.get('toPlace')?.touched"
          />
          <ul class="suggestions" *ngIf="showToSuggestions && toSuggestions.length > 0">
            <li *ngFor="let city of toSuggestions" (click)="selectToCity(city)">
              {{ city }}
            </li>
          </ul>
          <div class="no-suggestions" *ngIf="showToSuggestions && toSuggestions.length === 0">
            No cities found
          </div>
        </div>
        <div class="field-error" *ngIf="searchForm.get('toPlace')?.invalid && searchForm.get('toPlace')?.touched">
          Please enter destination city
        </div>
      </div>

      <!-- DEPARTURE DATE -->
      <div class="form-group">
        <label for="departureDate">Departure Date</label>
        <input 
          id="departureDate"
          type="date" 
          formControlName="departureDate"
          [min]="minDate"
          [class.invalid]="searchForm.get('departureDate')?.invalid && searchForm.get('departureDate')?.touched"
        />
        <div class="field-error" *ngIf="searchForm.get('departureDate')?.invalid && searchForm.get('departureDate')?.touched">
          Please select departure date
        </div>
      </div>

      <button 
        type="submit" 
        class="btn btn-primary"
        [disabled]="searchForm.invalid || loading"
      >
        {{ loading ? 'Searching...' : 'Search Flights' }}
      </button>

      <div *ngIf="error" class="error-message">
        {{ error }}
      </div>
    </form>
  </div>

  <!-- FLIGHTS LIST -->
  <div *ngIf="flights.length > 0" class="flights-list">
    <h2>Available Flights ({{ flights.length }})</h2>
    
    <div *ngFor="let flight of flights" class="flight-card">
      <div class="flight-header">
        <h3>{{ flight.airlineName }}</h3>
        <span class="flight-number">{{ flight.flightNumber }}</span>
      </div>
      
      <div class="flight-route">
        <div class="location">
          <span class="city">{{ flight.fromPlace }}</span>
          <span class="time">{{ flight.departureDateTime | date:'short' }}</span>
        </div>
        
        <div class="route-line">
          <span>→</span>
        </div>
        
        <div class="location">
          <span class="city">{{ flight.toPlace }}</span>
          <span class="time">{{ flight.arrivalDateTime | date:'short' }}</span>
        </div>
      </div>
      
      <div class="flight-details">
        <div class="detail-item">
          <span class="label">Price:</span>
          <span class="value price">₹{{ flight.price }}</span>
        </div>
        <div class="detail-item">
          <span class="label">Available Seats:</span>
          <span class="value">{{ flight.availableSeats }}</span>
        </div>
      </div>
      
      <button class="btn btn-book">Book Now</button>
    </div>
  </div>

  <!-- NO RESULTS -->
  <div *ngIf="!loading && flights.length === 0 && searchForm.touched" class="no-results">
    <p>No flights found for this route and date.</p>
    <p>Try different cities or dates.</p>
  </div>
</div>
